
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Loading Task Data &#8212; Task Prediction - fMRI Analysis</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Model Fitting" href="test_model_NMA.html" />
    <link rel="prev" title="Helper Script" href="project_main.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Task Prediction - fMRI Analysis</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="abstract.html">
   Abstract
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="extracting_data.html">
   Extracting Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="project_main.html">
   Helper Script
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Loading Task Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="test_model_NMA.html">
   Model Fitting
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="presentation.html">
   Presentation
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/HCP_fMRI_NMA.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FHCP_fMRI_NMA.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/HCP_fMRI_NMA.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#version-with-behavioural-data">
   (version with Behavioural Data)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-data">
   Downloading data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-the-folder-organisation">
   Understanding the folder organisation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-region-information">
   Loading region information
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examining-the-regions">
     Examining the regions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#help-functions">
   Help functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-run-emotion-task">
   Example run (EMOTION task)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trying-to-understand-evs-archived">
     Trying to understand evs (archived)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data1-average-bold-activity-for-individual-for-each-condition-and-contrast">
   📌Data1: Average BOLD activity for individual for each condition and contrast
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emotion">
   1.1 EMOTION
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#social-task">
   1.2 SOCIAL task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gambling-task">
   1.3 GAMBLING task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-csv-files">
   Writing csv files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#columns-for-360-areas">
     Columns for 360 areas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   SOCIAL Task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   GAMBLING task
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#try-plotting-the-average-frame-data-of-all-subjects">
     Try plotting the “average frame” data of ALL subjects
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contrast-and-network">
   Contrast and network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#average-across-all-subjects-and-runs">
   Average across all subjects and runs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualising-the-results-on-a-brain">
   Visualising the results on a brain
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#group-contrast-for-social-and-gambling-respectively">
     Group contrast for Social and Gambling respectively
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gambling">
   GAMBLING
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#archived-codes">
     Archived Codes
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Loading Task Data</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#version-with-behavioural-data">
   (version with Behavioural Data)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downloading-data">
   Downloading data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#understanding-the-folder-organisation">
   Understanding the folder organisation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-region-information">
   Loading region information
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examining-the-regions">
     Examining the regions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#help-functions">
   Help functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#example-run-emotion-task">
   Example run (EMOTION task)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#trying-to-understand-evs-archived">
     Trying to understand evs (archived)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data1-average-bold-activity-for-individual-for-each-condition-and-contrast">
   📌Data1: Average BOLD activity for individual for each condition and contrast
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#emotion">
   1.1 EMOTION
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#social-task">
   1.2 SOCIAL task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gambling-task">
   1.3 GAMBLING task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#writing-csv-files">
   Writing csv files
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#columns-for-360-areas">
     Columns for 360 areas
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   SOCIAL Task
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   GAMBLING task
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#try-plotting-the-average-frame-data-of-all-subjects">
     Try plotting the “average frame” data of ALL subjects
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#contrast-and-network">
   Contrast and network
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#average-across-all-subjects-and-runs">
   Average across all subjects and runs
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#visualising-the-results-on-a-brain">
   Visualising the results on a brain
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#group-contrast-for-social-and-gambling-respectively">
     Group contrast for Social and Gambling respectively
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gambling">
   GAMBLING
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#archived-codes">
     Archived Codes
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="loading-task-data">
<h1>Loading Task Data<a class="headerlink" href="#loading-task-data" title="Permalink to this heading">#</a></h1>
<hr class="docutils" />
<section id="version-with-behavioural-data">
<h2>(version with Behavioural Data)<a class="headerlink" href="#version-with-behavioural-data" title="Permalink to this heading">#</a></h2>
<p>The HCP dataset comprises task-based fMRI from a large sample of human subjects. The NMA-curated dataset includes time series data that has been preprocessed and spatially-downsampled by aggregating within 360 regions of interest.</p>
<p>In order to use this dataset, please electronically sign the HCP data use terms at <a class="reference external" href="https://db.humanconnectome.org">ConnectomeDB</a>. Instructions for this are on pp. 24-25 of the <a class="reference external" href="https://www.humanconnectome.org/storage/app/media/documentation/s1200/HCP_S1200_Release_Reference_Manual.pdf">HCP Reference Manual</a>.</p>
<p>In this notebook, NMA provides code for downloading the data and doing some basic visualisation and processing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># @title Install dependencies
!pip install nilearn --quiet
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">10.3/10.3 MB</span> <span class=" -Color -Color-Red">15.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ <span class=" -Color -Color-Green">3.3/3.3 MB</span> <span class=" -Color -Color-Red">19.7 MB/s</span> eta <span class=" -Color -Color-Cyan">0:00:00</span>
?25h
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Figure settings</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="o">%</span><span class="n">config</span> <span class="n">InlineBackend</span><span class="o">.</span><span class="n">figure_format</span> <span class="o">=</span> <span class="s1">&#39;retina&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/course-content/main/nma.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The data shared for NMA projects is a subset of the full HCP dataset</span>
<span class="n">N_SUBJECTS</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># The data have already been aggregated into ROIs from the Glasser parcellation</span>
<span class="n">N_PARCELS</span> <span class="o">=</span> <span class="mi">360</span>

<span class="c1"># The acquisition parameters for all tasks were identical</span>
<span class="n">TR</span> <span class="o">=</span> <span class="mf">0.72</span>  <span class="c1"># Time resolution, in seconds = Sampling rate</span>

<span class="c1"># The parcels are matched across hemispheres with the same order</span>
<span class="n">HEMIS</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Right&quot;</span><span class="p">,</span> <span class="s2">&quot;Left&quot;</span><span class="p">]</span>

<span class="c1"># Each experiment was repeated twice in each subject</span>
<span class="n">RUNS</span>   <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;LR&#39;</span><span class="p">,</span><span class="s1">&#39;RL&#39;</span><span class="p">]</span>
<span class="n">N_RUNS</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># There are 7 tasks. Each has a number of &#39;conditions&#39;</span>
<span class="c1"># TIP: look inside the data folders for more fine-graned conditions</span>

<span class="n">EXPERIMENTS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;MOTOR&#39;</span>      <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;lf&#39;</span><span class="p">,</span><span class="s1">&#39;rf&#39;</span><span class="p">,</span><span class="s1">&#39;lh&#39;</span><span class="p">,</span><span class="s1">&#39;rh&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;cue&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;WM&#39;</span>         <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;0bk_body&#39;</span><span class="p">,</span><span class="s1">&#39;0bk_faces&#39;</span><span class="p">,</span><span class="s1">&#39;0bk_places&#39;</span><span class="p">,</span><span class="s1">&#39;0bk_tools&#39;</span><span class="p">,</span><span class="s1">&#39;2bk_body&#39;</span><span class="p">,</span><span class="s1">&#39;2bk_faces&#39;</span><span class="p">,</span><span class="s1">&#39;2bk_places&#39;</span><span class="p">,</span><span class="s1">&#39;2bk_tools&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;EMOTION&#39;</span>    <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;fear&#39;</span><span class="p">,</span><span class="s1">&#39;neut&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;GAMBLING&#39;</span>   <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;loss&#39;</span><span class="p">,</span><span class="s1">&#39;win&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;LANGUAGE&#39;</span>   <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;math&#39;</span><span class="p">,</span><span class="s1">&#39;story&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;RELATIONAL&#39;</span> <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;match&#39;</span><span class="p">,</span><span class="s1">&#39;relation&#39;</span><span class="p">]},</span>
    <span class="s1">&#39;SOCIAL&#39;</span>     <span class="p">:</span> <span class="p">{</span><span class="s1">&#39;cond&#39;</span><span class="p">:[</span><span class="s1">&#39;mental&#39;</span><span class="p">,</span><span class="s1">&#39;rnd&#39;</span><span class="p">]}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p>For a detailed description of the tasks have a look pages 45-54 of the <a class="reference external" href="https://www.humanconnectome.org/storage/app/media/documentation/s1200/HCP_S1200_Release_Reference_Manual.pdf">HCP reference manual</a>.</p>
</div></blockquote>
</section>
<section id="downloading-data">
<h2>Downloading data<a class="headerlink" href="#downloading-data" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>The task data are shared in different files, but they will unpack into the same directory structure.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Download data file</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">requests</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s2">&quot;hcp_task.tgz&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://osf.io/2y3fw/download&quot;</span>

<span class="c1"># urls = [&quot;https://osf. io/bqp7m/download&quot;</span>
<span class="c1"># &quot;https://osf. io/s4h8j/download&quot;</span>
<span class="c1"># &quot;https://osf. io/x5p4g/download&quot;</span>
<span class="c1"># &quot;https://osf. io/j5kuc/download&quot;</span>

<span class="c1"># &quot;https://osf.io/s4h8i/download/&quot;  Bati provided this</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;!!! Failed to download data !!!&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;!!! Failed to download data !!!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
        <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The download cells will store the data in nested directories starting here:</span>
<span class="n">HCP_DIR</span> <span class="o">=</span> <span class="s2">&quot;./hcp_task&quot;</span>

<span class="c1"># importing the &quot;tarfile&quot; module</span>
<span class="kn">import</span> <span class="nn">tarfile</span>

<span class="c1"># open file</span>
<span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">tfile</span><span class="p">:</span>
  <span class="c1"># extracting file</span>
  <span class="n">tfile</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

<span class="n">subjects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HCP_DIR</span><span class="p">,</span> <span class="s1">&#39;subjects_list.txt&#39;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;str&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="understanding-the-folder-organisation">
<h2>Understanding the folder organisation<a class="headerlink" href="#understanding-the-folder-organisation" title="Permalink to this heading">#</a></h2>
<p>The data folder has the following organisation:</p>
<ul class="simple">
<li><p>hcp</p>
<ul>
<li><p>regions.npy (information on the brain parcellation)</p></li>
<li><p>subjects_list.txt (list of subject IDs)</p></li>
<li><p>subjects (main data folder)</p>
<ul>
<li><p>[subjectID] (subject-specific subfolder)</p>
<ul>
<li><p>EXPERIMENT (one folder per experiment)</p>
<ul>
<li><p>RUN (one folder per run)</p>
<ul>
<li><p>data.npy (the parcellated time series data)</p></li>
<li><p>EVs (EVs folder)</p>
<ul>
<li><p>[ev1.txt] (one file per condition)</p></li>
<li><p>[ev2.txt]</p></li>
<li><p>Stats.txt (behavioural data [where available] - averaged per run)</p></li>
<li><p>Sync.txt (ignore this file)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="loading-region-information">
<h2>Loading region information<a class="headerlink" href="#loading-region-information" title="Permalink to this heading">#</a></h2>
<p>Downloading this dataset will create the <code class="docutils literal notranslate"><span class="pre">regions.npy</span></code> file, which contains the region name and network assignment for each parcel.</p>
<p>Detailed information about the name used for each region is provided <a class="reference external" href="https://static-content.springer.com/esm/art%3A10.1038%2Fnature18933/MediaObjects/41586_2016_BFnature18933_MOESM330_ESM.pdf">in the Supplement</a> to <a class="reference external" href="https://www.nature.com/articles/nature18933">Glasser et al. 2016</a>.</p>
<p>Information about the network parcellation is provided in <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6289683/">Ji et al, 2019</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">regions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">HCP_DIR</span><span class="si">}</span><span class="s2">/regions.npy&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">region_info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="n">regions</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
    <span class="n">network</span><span class="o">=</span><span class="n">regions</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
    <span class="n">hemi</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Right&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">N_PARCELS</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;Left&#39;</span><span class="p">]</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">N_PARCELS</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of unique network name</span>
<span class="n">unique_net</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">]:</span>
  <span class="k">if</span> <span class="n">net</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">unique_net</span><span class="p">:</span>
      <span class="n">unique_net</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;there are &quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">unique_net</span><span class="p">),</span><span class="s2">&quot;unique networks.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">unique_net</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>there are  12 unique networks.
[&#39;Visual1&#39;, &#39;Visual2&#39;, &#39;Somatomotor&#39;, &#39;Cingulo-Oper&#39;, &#39;Language&#39;, &#39;Default&#39;, &#39;Frontopariet&#39;, &#39;Auditory&#39;, &#39;Dorsal-atten&#39;, &#39;Posterior-Mu&#39;, &#39;Orbito-Affec&#39;, &#39;Ventral-Mult&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#list of regions in each network</span>
<span class="n">dict_reg_in_net</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">net</span> <span class="ow">in</span> <span class="n">unique_net</span><span class="p">:</span>
  <span class="n">dict_reg_in_net</span><span class="p">[</span><span class="n">net</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1">#establish empty list associate with key &#39;str of network&#39;</span>
  <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">])):</span>
    <span class="n">current_brain_reg</span> <span class="o">=</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span> <span class="o">==</span> <span class="n">net</span> <span class="ow">and</span> <span class="p">(</span><span class="n">current_brain_reg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">dict_reg_in_net</span><span class="p">[</span><span class="n">net</span><span class="p">]):</span>
      <span class="n">dict_reg_in_net</span><span class="p">[</span><span class="n">net</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_brain_reg</span><span class="p">)</span>

<span class="k">for</span> <span class="n">network</span><span class="p">,</span><span class="n">list_reg</span> <span class="ow">in</span> <span class="n">dict_reg_in_net</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Network name: &quot;</span><span class="p">,</span> <span class="n">network</span><span class="p">,</span> <span class="s2">&quot;contains &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_reg</span><span class="p">),</span><span class="s2">&quot; regions:&quot;</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">list_reg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Network name:  Visual1 contains  6  regions:
[&#39;R_V1&#39;, &#39;R_ProS&#39;, &#39;R_DVT&#39;, &#39;L_V1&#39;, &#39;L_ProS&#39;, &#39;L_DVT&#39;]
Network name:  Visual2 contains  54  regions:
[&#39;R_MST&#39;, &#39;R_V6&#39;, &#39;R_V2&#39;, &#39;R_V3&#39;, &#39;R_V4&#39;, &#39;R_V8&#39;, &#39;R_V3A&#39;, &#39;R_V7&#39;, &#39;R_IPS1&#39;, &#39;R_FFC&#39;, &#39;R_V3B&#39;, &#39;R_LO1&#39;, &#39;R_LO2&#39;, &#39;R_PIT&#39;, &#39;R_MT&#39;, &#39;R_LIPv&#39;, &#39;R_VIP&#39;, &#39;R_PH&#39;, &#39;R_V6A&#39;, &#39;R_VMV1&#39;, &#39;R_VMV3&#39;, &#39;R_V4t&#39;, &#39;R_FST&#39;, &#39;R_V3CD&#39;, &#39;R_LO3&#39;, &#39;R_VMV2&#39;, &#39;R_VVC&#39;, &#39;L_MST&#39;, &#39;L_V6&#39;, &#39;L_V2&#39;, &#39;L_V3&#39;, &#39;L_V4&#39;, &#39;L_V8&#39;, &#39;L_V3A&#39;, &#39;L_V7&#39;, &#39;L_IPS1&#39;, &#39;L_FFC&#39;, &#39;L_V3B&#39;, &#39;L_LO1&#39;, &#39;L_LO2&#39;, &#39;L_PIT&#39;, &#39;L_MT&#39;, &#39;L_LIPv&#39;, &#39;L_VIP&#39;, &#39;L_PH&#39;, &#39;L_V6A&#39;, &#39;L_VMV1&#39;, &#39;L_VMV3&#39;, &#39;L_V4t&#39;, &#39;L_FST&#39;, &#39;L_V3CD&#39;, &#39;L_LO3&#39;, &#39;L_VMV2&#39;, &#39;L_VVC&#39;]
Network name:  Somatomotor contains  39  regions:
[&#39;R_4&#39;, &#39;R_3b&#39;, &#39;R_5m&#39;, &#39;R_5L&#39;, &#39;R_24dd&#39;, &#39;R_24dv&#39;, &#39;R_7AL&#39;, &#39;R_7PC&#39;, &#39;R_1&#39;, &#39;R_2&#39;, &#39;R_3a&#39;, &#39;R_6d&#39;, &#39;R_6mp&#39;, &#39;R_6v&#39;, &#39;R_OP4&#39;, &#39;R_OP1&#39;, &#39;R_OP2-3&#39;, &#39;R_FOP2&#39;, &#39;R_Ig&#39;, &#39;L_4&#39;, &#39;L_3b&#39;, &#39;L_5m&#39;, &#39;L_5L&#39;, &#39;L_24dd&#39;, &#39;L_24dv&#39;, &#39;L_7AL&#39;, &#39;L_7PC&#39;, &#39;L_1&#39;, &#39;L_2&#39;, &#39;L_3a&#39;, &#39;L_6d&#39;, &#39;L_6mp&#39;, &#39;L_6v&#39;, &#39;L_OP4&#39;, &#39;L_OP1&#39;, &#39;L_OP2-3&#39;, &#39;L_RI&#39;, &#39;L_FOP2&#39;, &#39;L_Ig&#39;]
Network name:  Cingulo-Oper contains  56  regions:
[&#39;R_FEF&#39;, &#39;R_5mv&#39;, &#39;R_23c&#39;, &#39;R_SCEF&#39;, &#39;R_6ma&#39;, &#39;R_7Am&#39;, &#39;R_p24pr&#39;, &#39;R_33pr&#39;, &#39;R_a24pr&#39;, &#39;R_p32pr&#39;, &#39;R_6r&#39;, &#39;R_46&#39;, &#39;R_9-46d&#39;, &#39;R_43&#39;, &#39;R_PFcm&#39;, &#39;R_PoI2&#39;, &#39;R_FOP4&#39;, &#39;R_MI&#39;, &#39;R_FOP1&#39;, &#39;R_FOP3&#39;, &#39;R_PFop&#39;, &#39;R_PF&#39;, &#39;R_PoI1&#39;, &#39;R_FOP5&#39;, &#39;R_PI&#39;, &#39;R_a32pr&#39;, &#39;R_p24&#39;, &#39;L_FEF&#39;, &#39;L_PEF&#39;, &#39;L_PSL&#39;, &#39;L_5mv&#39;, &#39;L_23c&#39;, &#39;L_SCEF&#39;, &#39;L_6ma&#39;, &#39;L_7Am&#39;, &#39;L_p24pr&#39;, &#39;L_a24pr&#39;, &#39;L_p32pr&#39;, &#39;L_6r&#39;, &#39;L_IFSa&#39;, &#39;L_46&#39;, &#39;L_9-46d&#39;, &#39;L_43&#39;, &#39;L_PFcm&#39;, &#39;L_PoI2&#39;, &#39;L_FOP4&#39;, &#39;L_MI&#39;, &#39;L_FOP1&#39;, &#39;L_FOP3&#39;, &#39;L_PFop&#39;, &#39;L_PF&#39;, &#39;L_PoI1&#39;, &#39;L_FOP5&#39;, &#39;L_PI&#39;, &#39;L_a32pr&#39;, &#39;L_p24&#39;]
Network name:  Language contains  23  regions:
[&#39;R_PEF&#39;, &#39;R_7PL&#39;, &#39;R_MIP&#39;, &#39;R_LIPd&#39;, &#39;R_6a&#39;, &#39;R_PFt&#39;, &#39;R_AIP&#39;, &#39;R_PHA3&#39;, &#39;R_TE2p&#39;, &#39;R_PHT&#39;, &#39;R_PGp&#39;, &#39;R_IP0&#39;, &#39;L_7PL&#39;, &#39;L_MIP&#39;, &#39;L_LIPd&#39;, &#39;L_6a&#39;, &#39;L_PFt&#39;, &#39;L_AIP&#39;, &#39;L_PHA3&#39;, &#39;L_TE2p&#39;, &#39;L_PHT&#39;, &#39;L_PGp&#39;, &#39;L_IP0&#39;]
Network name:  Default contains  23  regions:
[&#39;R_55b&#39;, &#39;R_PSL&#39;, &#39;R_SFL&#39;, &#39;R_STV&#39;, &#39;R_44&#39;, &#39;R_45&#39;, &#39;R_IFJa&#39;, &#39;R_IFSp&#39;, &#39;R_STGa&#39;, &#39;R_A5&#39;, &#39;R_STSda&#39;, &#39;R_STSdp&#39;, &#39;R_TPOJ1&#39;, &#39;R_TGv&#39;, &#39;L_55b&#39;, &#39;L_SFL&#39;, &#39;L_45&#39;, &#39;L_IFJa&#39;, &#39;L_STGa&#39;, &#39;L_A5&#39;, &#39;L_STSdp&#39;, &#39;L_TPOJ1&#39;, &#39;L_TGv&#39;]
Network name:  Frontopariet contains  50  regions:
[&#39;R_RSC&#39;, &#39;R_POS2&#39;, &#39;R_7Pm&#39;, &#39;R_8BM&#39;, &#39;R_8C&#39;, &#39;R_a47r&#39;, &#39;R_IFJp&#39;, &#39;R_IFSa&#39;, &#39;R_p9-46v&#39;, &#39;R_a9-46v&#39;, &#39;R_a10p&#39;, &#39;R_11l&#39;, &#39;R_13l&#39;, &#39;R_i6-8&#39;, &#39;R_s6-8&#39;, &#39;R_AVI&#39;, &#39;R_TE1p&#39;, &#39;R_IP2&#39;, &#39;R_IP1&#39;, &#39;R_PFm&#39;, &#39;R_p10p&#39;, &#39;R_p47r&#39;, &#39;L_RSC&#39;, &#39;L_POS2&#39;, &#39;L_7Pm&#39;, &#39;L_33pr&#39;, &#39;L_d32&#39;, &#39;L_8BM&#39;, &#39;L_8C&#39;, &#39;L_44&#39;, &#39;L_a47r&#39;, &#39;L_IFJp&#39;, &#39;L_IFSp&#39;, &#39;L_p9-46v&#39;, &#39;L_a9-46v&#39;, &#39;L_a10p&#39;, &#39;L_11l&#39;, &#39;L_13l&#39;, &#39;L_OFC&#39;, &#39;L_i6-8&#39;, &#39;L_s6-8&#39;, &#39;L_AVI&#39;, &#39;L_TE1p&#39;, &#39;L_IP2&#39;, &#39;L_IP1&#39;, &#39;L_PFm&#39;, &#39;L_31a&#39;, &#39;L_p10p&#39;, &#39;L_p47r&#39;, &#39;L_TE1m&#39;]
Network name:  Auditory contains  15  regions:
[&#39;R_A1&#39;, &#39;R_52&#39;, &#39;R_RI&#39;, &#39;R_TA2&#39;, &#39;R_PBelt&#39;, &#39;R_MBelt&#39;, &#39;R_LBelt&#39;, &#39;R_A4&#39;, &#39;L_A1&#39;, &#39;L_52&#39;, &#39;L_TA2&#39;, &#39;L_PBelt&#39;, &#39;L_MBelt&#39;, &#39;L_LBelt&#39;, &#39;L_A4&#39;]
Network name:  Dorsal-atten contains  7  regions:
[&#39;R_PCV&#39;, &#39;R_TPOJ2&#39;, &#39;R_TPOJ3&#39;, &#39;L_PCV&#39;, &#39;L_STV&#39;, &#39;L_TPOJ2&#39;, &#39;L_TPOJ3&#39;]
Network name:  Posterior-Mu contains  77  regions:
[&#39;R_7m&#39;, &#39;R_POS1&#39;, &#39;R_23d&#39;, &#39;R_v23ab&#39;, &#39;R_d23ab&#39;, &#39;R_31pv&#39;, &#39;R_a24&#39;, &#39;R_d32&#39;, &#39;R_p32&#39;, &#39;R_10r&#39;, &#39;R_47m&#39;, &#39;R_8Av&#39;, &#39;R_8Ad&#39;, &#39;R_9m&#39;, &#39;R_8BL&#39;, &#39;R_9p&#39;, &#39;R_10d&#39;, &#39;R_47l&#39;, &#39;R_9a&#39;, &#39;R_10v&#39;, &#39;R_10pp&#39;, &#39;R_OFC&#39;, &#39;R_47s&#39;, &#39;R_EC&#39;, &#39;R_PreS&#39;, &#39;R_H&#39;, &#39;R_PHA1&#39;, &#39;R_STSvp&#39;, &#39;R_TGd&#39;, &#39;R_TE1a&#39;, &#39;R_TE2a&#39;, &#39;R_PGi&#39;, &#39;R_PGs&#39;, &#39;R_PHA2&#39;, &#39;R_31pd&#39;, &#39;R_31a&#39;, &#39;R_25&#39;, &#39;R_s32&#39;, &#39;R_STSva&#39;, &#39;R_TE1m&#39;, &#39;L_7m&#39;, &#39;L_POS1&#39;, &#39;L_23d&#39;, &#39;L_v23ab&#39;, &#39;L_d23ab&#39;, &#39;L_31pv&#39;, &#39;L_a24&#39;, &#39;L_p32&#39;, &#39;L_10r&#39;, &#39;L_47m&#39;, &#39;L_8Av&#39;, &#39;L_8Ad&#39;, &#39;L_9m&#39;, &#39;L_8BL&#39;, &#39;L_9p&#39;, &#39;L_10d&#39;, &#39;L_47l&#39;, &#39;L_9a&#39;, &#39;L_10v&#39;, &#39;L_10pp&#39;, &#39;L_47s&#39;, &#39;L_EC&#39;, &#39;L_PreS&#39;, &#39;L_H&#39;, &#39;L_PHA1&#39;, &#39;L_STSda&#39;, &#39;L_STSvp&#39;, &#39;L_TGd&#39;, &#39;L_TE1a&#39;, &#39;L_TE2a&#39;, &#39;L_PGi&#39;, &#39;L_PGs&#39;, &#39;L_PHA2&#39;, &#39;L_31pd&#39;, &#39;L_25&#39;, &#39;L_s32&#39;, &#39;L_STSva&#39;]
Network name:  Orbito-Affec contains  6  regions:
[&#39;R_Pir&#39;, &#39;R_AAIC&#39;, &#39;R_pOFC&#39;, &#39;L_Pir&#39;, &#39;L_AAIC&#39;, &#39;L_pOFC&#39;]
Network name:  Ventral-Mult contains  4  regions:
[&#39;R_PeEc&#39;, &#39;R_TF&#39;, &#39;L_PeEc&#39;, &#39;L_TF&#39;]
</pre></div>
</div>
</div>
</div>
<section id="examining-the-regions">
<h3>Examining the regions<a class="headerlink" href="#examining-the-regions" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#examine the regions by myself</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">regions</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">regions</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">region_info</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
[[&#39;R_V1&#39; &#39;R_MST&#39; &#39;R_V6&#39; ... &#39;L_PI&#39; &#39;L_a32pr&#39; &#39;L_p24&#39;]
 [&#39;Visual1&#39; &#39;Visual2&#39; &#39;Visual2&#39; ... &#39;Cingulo-Oper&#39; &#39;Cingulo-Oper&#39;
  &#39;Cingulo-Oper&#39;]
 [&#39;2.209&#39; &#39;2.05561&#39; &#39;2.1498&#39; ... &#39;1.74335&#39; &#39;1.73082&#39; &#39;1.65968&#39;]]
360
dict_keys([&#39;name&#39;, &#39;network&#39;, &#39;hemi&#39;])
[&#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Right&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;, &#39;Left&#39;]
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="help-functions">
<h2>Help functions<a class="headerlink" href="#help-functions" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>We provide two helper functions: one for loading the time series from a single suject and a single run, and one for loading an EV file for each task.</p>
<p>An EV file (EV:Explanatory Variable) describes the task experiment in terms of stimulus onset, duration, and amplitude. These can be used to model the task time series data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Load timeseries data for a single subject and single run.</span>

<span class="sd">  Args:</span>
<span class="sd">    subject (str):      subject ID to load</span>
<span class="sd">    experiment (str):   Name of experiment</span>
<span class="sd">    run (int):          (0 or 1)</span>
<span class="sd">    remove_mean (bool): If True, subtract the parcel-wise mean (typically the mean BOLD signal is not of interest)</span>

<span class="sd">  Returns</span>
<span class="sd">    ts (n_parcel x n_timepoint array): Array of BOLD data values</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">bold_run</span>  <span class="o">=</span> <span class="n">RUNS</span><span class="p">[</span><span class="n">run</span><span class="p">]</span>
  <span class="n">bold_path</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">HCP_DIR</span><span class="si">}</span><span class="s2">/subjects/</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2">/tfMRI_</span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">bold_run</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="n">bold_file</span> <span class="o">=</span> <span class="s2">&quot;data.npy&quot;</span>
  <span class="n">ts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bold_path</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">bold_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1">#ts is timeseries</span>
  <span class="c1"># print(&quot;this is ts&quot;,ts)</span>
  <span class="c1"># print(&quot;len(t)&quot;,len(ts))</span>
  <span class="c1"># print(&quot;ts.mean(axis=1, keepdims=True)&quot;, ts.mean(axis=1, keepdims=True))</span>
  <span class="k">if</span> <span class="n">remove_mean</span><span class="p">:</span>
    <span class="n">ts</span> <span class="o">-=</span> <span class="n">ts</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">ts</span>


<span class="k">def</span> <span class="nf">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">run</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;Load EVs (explanatory variables) data for one task experiment.</span>

<span class="sd">  Args:</span>
<span class="sd">    subject (str): subject ID to load</span>
<span class="sd">    experiment (str) : Name of experiment</span>
<span class="sd">    run (int): 0 or 1</span>

<span class="sd">  Returns</span>
<span class="sd">    evs (list of lists): A list of frames associated with each condition</span>

<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">frames_list</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">task_key</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;tfMRI_</span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">RUNS</span><span class="p">[</span><span class="n">run</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span>
  <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">EXPERIMENTS</span><span class="p">[</span><span class="n">experiment</span><span class="p">][</span><span class="s1">&#39;cond&#39;</span><span class="p">]:</span>
    <span class="n">ev_file</span>  <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">HCP_DIR</span><span class="si">}</span><span class="s2">/subjects/</span><span class="si">{</span><span class="n">subject</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">experiment</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">task_key</span><span class="si">}</span><span class="s2">/EVs/</span><span class="si">{</span><span class="n">cond</span><span class="si">}</span><span class="s2">.txt&quot;</span>
    <span class="n">ev_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">ev_file</span><span class="p">,</span> <span class="n">ndmin</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># print(&quot;ev_array&quot;,ev_array) ; basically just array of what&#39;s in txt file</span>
    <span class="n">ev</span>       <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s2">&quot;onset&quot;</span><span class="p">,</span> <span class="s2">&quot;duration&quot;</span><span class="p">,</span> <span class="s2">&quot;amplitude&quot;</span><span class="p">],</span> <span class="n">ev_array</span><span class="p">))</span>

    <span class="c1"># Determine when trial starts, rounded down</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="s2">&quot;onset&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">TR</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># this is start index for each frame</span>
    <span class="c1"># Use trial duration to determine how many frames to include for trial</span>
    <span class="n">duration</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">ev</span><span class="p">[</span><span class="s2">&quot;duration&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">TR</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="c1"># this is **how many** indices for that frame</span>


    <span class="c1"># Take the range of frames that correspond to this specific trial</span>
    <span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">s</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">duration</span><span class="p">)]</span>
    <span class="n">frames_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">frames_list</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="example-run-emotion-task">
<h2>Example run (EMOTION task)<a class="headerlink" href="#example-run-emotion-task" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Let’s load the timeseries data for the MOTOR experiment from a single subject and a single run</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;EMOTION&#39;</span>
<span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                              <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                              <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                              <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(360, 176)
</pre></div>
</div>
</div>
</div>
<p>As you can see the time series data contains 284 time points in 360 regions of interest (ROIs).</p>
<p>Now in order to understand how to model these data, we need to relate the time series to the experimental manipulation. This is described by the EV files. Let us load the EVs for this experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="trying-to-understand-evs-archived">
<h3>Trying to understand evs (archived)<a class="headerlink" href="#trying-to-understand-evs-archived" title="Permalink to this heading">#</a></h3>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frames of first cond:&quot;</span><span class="p">,</span><span class="n">evs</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;frames of second cond: &quot;</span><span class="p">,</span><span class="n">evs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evs</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>frames of first cond: [array([44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
       61, 62, 63, 64, 65, 66, 67, 68]), array([103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115,
       116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]), array([161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173,
       174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185])]
frames of second cond:  [array([15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31,
       32, 33, 34, 35, 36, 37, 38, 39]), array([73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,
       90, 91, 92, 93, 94, 95, 96, 97]), array([132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144,
       145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156])]
2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># idx = 0 for &#39;fear&#39; condition in &#39;EMOTION task&#39; and idx = 1 for &#39;neut&#39;</span>
<span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">])):</span>
  <span class="nb">print</span><span class="p">(</span><span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>


</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67
 68]
[103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120
 121 122 123 124 125 126 127]
[161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178
 179 180 181 182 183 184 185]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>176
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># print(evs[0])</span>
<span class="c1"># print(data.shape[1])</span>
<span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">frames_cond</span> <span class="o">=</span> <span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;before removing&quot;</span><span class="p">,</span><span class="n">frames_cond</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">frame</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="c1">#if the time index in frame is larger than the datashape, exclude that frame</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;index where it exceeds data frame: &quot;</span><span class="p">,</span><span class="n">i</span><span class="p">)</span>
    <span class="n">frames_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;after removing the elements&quot;</span><span class="p">,</span><span class="n">frames_cond</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>before removing [array([44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60,
       61, 62, 63, 64, 65, 66, 67, 68]), array([103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115,
       116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127]), array([161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173,
       174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185])]
index where it exceeds data frame:  2
after removing the elements [[ 44  45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61
   62  63  64  65  66  67  68]
 [103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120
  121 122 123 124 125 126 127]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;numpy.ndarray&#39;&gt;
</pre></div>
</div>
</div>
</div>
<p>For the motor task, this evs variable contains a list of 5 arrays corresponding to the 5 conditions.</p>
<p>Now let’s use these evs to compare the average activity during the left foot (‘lf’) and right foot (‘rf’) conditions:</p>
<p>##Back to the core code</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># we need a little function that averages all frames from any given condition</span>

<span class="k">def</span> <span class="nf">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span><span class="n">experiment</span><span class="p">,</span><span class="n">cond</span><span class="p">):</span>
  <span class="c1"># get idx for the specific condition (ex. fear/neut)</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="n">EXPERIMENTS</span><span class="p">[</span><span class="n">experiment</span><span class="p">][</span><span class="s1">&#39;cond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
  <span class="c1"># get rid of the index that exceed the dataframe</span>
  <span class="n">frames_cond</span> <span class="o">=</span> <span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">frame</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">frame</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span> <span class="c1">#if the time index in frame is larger than the datashape, exclude that frame</span>
      <span class="n">frames_cond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#note the frams_cond is still np.array</span>

  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">frames_cond</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">frames_cond</span><span class="p">))],</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="n">fear_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;fear&#39;</span><span class="p">)</span>
<span class="n">neut_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;neut&#39;</span><span class="p">)</span>
<span class="n">contrast_emotion</span> <span class="o">=</span> <span class="n">fear_activity</span><span class="o">-</span><span class="n">neut_activity</span>

<span class="c1">#print(fear_activity)</span>
<span class="c1">#fear_activity = average_frames(data, evs, my_exp, &#39;fear&#39;)</span>
<span class="c1">#contrast = lf_activity - rf_activity  # difference between left and right hand movement</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot activity level in each ROI for both conditions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">fear_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;fear&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">neut_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;neutral&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/HCP_fMRI_NMA_32_0.png" src="_images/HCP_fMRI_NMA_32_0.png" />
</div>
</div>
</section>
</section>
<section id="data1-average-bold-activity-for-individual-for-each-condition-and-contrast">
<h2>📌Data1: Average BOLD activity for individual for each condition and contrast<a class="headerlink" href="#data1-average-bold-activity-for-individual-for-each-condition-and-contrast" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">arr_1D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span> <span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>

<span class="n">arr_1D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">arr_1D</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">arr_1D</span> <span class="o">==</span> <span class="mi">8</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">arr_1D</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1 2 3 4 5 6 7]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;100307&#39; &#39;100408&#39; &#39;101915&#39; &#39;102816&#39; &#39;103414&#39; &#39;103515&#39; &#39;103818&#39; &#39;105115&#39;
 &#39;105216&#39; &#39;106016&#39; &#39;106319&#39; &#39;110411&#39; &#39;111009&#39; &#39;111312&#39; &#39;111514&#39; &#39;111716&#39;
 &#39;113215&#39; &#39;113619&#39; &#39;114924&#39; &#39;115320&#39; &#39;117122&#39; &#39;117324&#39; &#39;118730&#39; &#39;118932&#39;
 &#39;119833&#39; &#39;120111&#39; &#39;120212&#39; &#39;122317&#39; &#39;123117&#39; &#39;124422&#39; &#39;125525&#39; &#39;126325&#39;
 &#39;127933&#39; &#39;128632&#39; &#39;129028&#39; &#39;130013&#39; &#39;130316&#39; &#39;130922&#39; &#39;131924&#39; &#39;133625&#39;
 &#39;133827&#39; &#39;133928&#39; &#39;134324&#39; &#39;135932&#39; &#39;136833&#39; &#39;137128&#39; &#39;138231&#39; &#39;138534&#39;
 &#39;139637&#39; &#39;140824&#39; &#39;142828&#39; &#39;143325&#39; &#39;148032&#39; &#39;148335&#39; &#39;149337&#39; &#39;149539&#39;
 &#39;150524&#39; &#39;151223&#39; &#39;151526&#39; &#39;151627&#39; &#39;153025&#39; &#39;153429&#39; &#39;154431&#39; &#39;156233&#39;
 &#39;156637&#39; &#39;157336&#39; &#39;158035&#39; &#39;158540&#39; &#39;159239&#39; &#39;159340&#39; &#39;160123&#39; &#39;161731&#39;
 &#39;162329&#39; &#39;162733&#39; &#39;163129&#39; &#39;163432&#39; &#39;167743&#39; &#39;172332&#39; &#39;175439&#39; &#39;176542&#39;
 &#39;178950&#39; &#39;182739&#39; &#39;185139&#39; &#39;188347&#39; &#39;189450&#39; &#39;190031&#39; &#39;192439&#39; &#39;192540&#39;
 &#39;193239&#39; &#39;194140&#39; &#39;196144&#39; &#39;196750&#39; &#39;197550&#39; &#39;198451&#39; &#39;199150&#39; &#39;199655&#39;
 &#39;200614&#39; &#39;201111&#39; &#39;201414&#39; &#39;205119&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">exc_subjects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">subjects</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">subjects</span> <span class="o">==</span> <span class="s1">&#39;133827&#39;</span><span class="p">))</span>
<span class="n">exc_subjects</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">exc_subjects</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">subjects</span> <span class="o">==</span> <span class="s1">&#39;192439&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">exc_subjects</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98
</pre></div>
</div>
</div>
</div>
</section>
<section id="emotion">
<h2>1.1 EMOTION<a class="headerlink" href="#emotion" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;EMOTION&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_indiv_BOLD_fear</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_BOLD_neut</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_contrast_emotion</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_fear</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_neut</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: fear</span>
    <span class="n">fear_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;fear&#39;</span><span class="p">)</span>
    <span class="n">subj_fear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fear_activity</span><span class="p">)</span>
    <span class="c1">#cond: neutral</span>
    <span class="n">neut_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;neut&#39;</span><span class="p">)</span>
    <span class="n">subj_neut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neut_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">list_indiv_BOLD_fear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_fear</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_BOLD_neut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_neut</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_contrast_emotion</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_fear</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_neut</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>

</pre></div>
</div>
</div>
</div>
<p>###Emotion Network (contrast only)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#GET Network</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;EMOTION&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_contrast_net_emotion</span><span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_fear</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_neut</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: fear</span>
    <span class="n">fear_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;fear&#39;</span><span class="p">)</span>
    <span class="n">subj_fear</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fear_activity</span><span class="p">)</span>
    <span class="c1">#cond: neutral</span>
    <span class="n">neut_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;neut&#39;</span><span class="p">)</span>
    <span class="n">subj_neut</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">neut_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">subj_fear_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_fear</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">subj_neut_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_neut</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="c1">#Turn 360 regions into 12 networks; do not average over hemisphere so in the end each subj will have 24 features</span>

  <span class="c1">#Dataframe for emotion</span>
  <span class="n">df_emotion</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fear_activity&#39;</span> <span class="p">:</span> <span class="n">subj_fear_avg</span><span class="p">,</span>
                   <span class="s1">&#39;neut_activity&#39;</span> <span class="p">:</span> <span class="n">subj_neut_avg</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]})</span>
  <span class="c1">#fear</span>
  <span class="n">list_fear_net</span> <span class="o">=</span> <span class="n">df_emotion</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;fear_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

  <span class="c1">#neut</span>
  <span class="n">list_neut_net</span> <span class="o">=</span> <span class="n">df_emotion</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;neut_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  <span class="c1">#contrast net</span>
  <span class="n">list_contrast_net_emotion</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">list_fear_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">list_neut_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_neut_net</span><span class="p">))</span> <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_emotion</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_emotion</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98
24
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># df_emotion.groupby([&quot;network&quot;,&quot;hemi&quot; ])[&quot;fear_activity&quot;].mean()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>network       hemi 
Auditory      Left     10.081486
              Right    15.384364
Cingulo-Oper  Left      5.887301
              Right     2.643987
Default       Left     13.471703
              Right    10.622781
Dorsal-atten  Left     12.426185
              Right     5.293913
Frontopariet  Left     13.901216
              Right    17.991914
Language      Left      8.173584
              Right    17.617729
Orbito-Affec  Left     16.362953
              Right    13.828290
Posterior-Mu  Left     13.223771
              Right    11.458556
Somatomotor   Left      5.805786
              Right     9.444462
Ventral-Mult  Left     26.618241
              Right    18.130791
Visual1       Left      9.248596
              Right    30.443386
Visual2       Left     17.406913
              Right    23.369150
Name: fear_activity, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="social-task">
<h2>1.2 SOCIAL task<a class="headerlink" href="#social-task" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;SOCIAL&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_indiv_BOLD_mental</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_BOLD_random</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_contrast_social</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_mental</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_random</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: mental</span>
    <span class="n">mental_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;mental&#39;</span><span class="p">)</span>
    <span class="n">subj_mental</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mental_activity</span><span class="p">)</span>
    <span class="c1">#cond: random</span>
    <span class="n">random_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;rnd&#39;</span><span class="p">)</span>
    <span class="n">subj_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">list_indiv_BOLD_mental</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_mental</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_BOLD_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_random</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_contrast_social</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_mental</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_random</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>###Social Network (contrast only)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1">#GET Network</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;SOCIAL&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_contrast_net_social</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_mental</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_random</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: mental</span>
    <span class="n">mental_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;mental&#39;</span><span class="p">)</span>
    <span class="n">subj_mental</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mental_activity</span><span class="p">)</span>
    <span class="c1">#cond: random</span>
    <span class="n">random_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;rnd&#39;</span><span class="p">)</span>
    <span class="n">subj_random</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">random_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">subj_mental_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_mental</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">subj_random_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_random</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="c1">#Turn 360 regions into 12 networks; do not average over hemisphere so in the end each subj will have 24 features</span>

  <span class="c1">#Dataframe for emotion</span>
  <span class="n">df_social</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mental_activity&#39;</span> <span class="p">:</span> <span class="n">subj_mental_avg</span><span class="p">,</span>
                   <span class="s1">&#39;random_activity&#39;</span> <span class="p">:</span> <span class="n">subj_random_avg</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]})</span>
  <span class="c1">#mental</span>
  <span class="n">list_mental_net</span> <span class="o">=</span> <span class="n">df_social</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;mental_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

  <span class="c1">#random</span>
  <span class="n">list_random_net</span> <span class="o">=</span> <span class="n">df_social</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;random_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  <span class="c1">#contrast net</span>
  <span class="n">list_contrast_net_social</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">list_mental_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">list_random_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_random_net</span><span class="p">))</span> <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_social</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_social</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98
24
</pre></div>
</div>
</div>
</div>
</section>
<section id="gambling-task">
<h2>1.3 GAMBLING task<a class="headerlink" href="#gambling-task" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;GAMBLING&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_indiv_BOLD_win</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_BOLD_loss</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_indiv_contrast_gambling</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_win</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_loss</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: mental</span>
    <span class="n">win_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="n">subj_win</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win_activity</span><span class="p">)</span>
    <span class="c1">#cond: random</span>
    <span class="n">loss_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">)</span>
    <span class="n">subj_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">list_indiv_BOLD_win</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_win</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_BOLD_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_loss</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
  <span class="n">list_indiv_contrast_gambling</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_win</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_loss</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>###Gambling Network (contrast only)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="c1">#GET Network</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;GAMBLING&#39;</span>
<span class="c1">#initialize array for keeping the data</span>
<span class="n">list_contrast_net_gambling</span><span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i_subj</span> <span class="ow">in</span> <span class="n">exc_subjects</span><span class="p">:</span>
  <span class="n">subj_win</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="n">subj_loss</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i_run</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">i_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">i_run</span><span class="p">)</span>

    <span class="c1">#cond: mental</span>
    <span class="n">win_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="n">subj_win</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">win_activity</span><span class="p">)</span>
    <span class="c1">#cond: random</span>
    <span class="n">loss_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">)</span>
    <span class="n">subj_loss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_activity</span><span class="p">)</span>

  <span class="c1">#average of 2 runs and append to list_indiv_BOLD</span>
  <span class="n">subj_win_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_win</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  <span class="n">subj_loss_avg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">subj_loss</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

  <span class="c1">#Turn 360 regions into 12 networks; do not average over hemisphere so in the end each subj will have 24 features</span>

  <span class="c1">#Dataframe for emotion</span>
  <span class="n">df_gambling</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;win_activity&#39;</span> <span class="p">:</span> <span class="n">subj_win_avg</span><span class="p">,</span>
                   <span class="s1">&#39;loss_activity&#39;</span> <span class="p">:</span> <span class="n">subj_loss_avg</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]})</span>
  <span class="c1">#win</span>
  <span class="n">list_win_net</span> <span class="o">=</span> <span class="n">df_gambling</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;win_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

  <span class="c1">#loss</span>
  <span class="n">list_loss_net</span> <span class="o">=</span> <span class="n">df_gambling</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s2">&quot;network&quot;</span><span class="p">,</span><span class="s2">&quot;hemi&quot;</span> <span class="p">])[</span><span class="s2">&quot;loss_activity&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
  <span class="c1">#contrast net</span>
  <span class="n">list_contrast_net_gambling</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">list_win_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">list_loss_net</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_win_net</span><span class="p">))</span> <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#Check</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_gambling</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_gambling</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>98
24
</pre></div>
</div>
</div>
</div>
</section>
<section id="writing-csv-files">
<h2>Writing csv files<a class="headerlink" href="#writing-csv-files" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#network columns</span>

<span class="n">network_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Auditory_L&#39;</span><span class="p">,</span><span class="s1">&#39;Auditory_R&#39;</span><span class="p">,</span><span class="s1">&#39;Cingulo-Oper_L&#39;</span><span class="p">,</span><span class="s1">&#39;Cingulo-Oper_R&#39;</span><span class="p">,</span><span class="s1">&#39;Default_L&#39;</span><span class="p">,</span><span class="s1">&#39;Default_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Dorsal-atten_L&#39;</span><span class="p">,</span><span class="s1">&#39;Dorsal-atten_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Frontopariet_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Frontopariet_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Language_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Language_R&#39;</span> <span class="p">,</span> <span class="s1">&#39;Orbito-Affec_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Orbito-Affec_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Posterior-Mu_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Posterior-Mu_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Somatomotor_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Somatomotor_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventral-Mult_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Ventral-Mult_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Visual1_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Visual1_R&#39;</span><span class="p">,</span> <span class="s1">&#39;Visual2_L&#39;</span><span class="p">,</span> <span class="s1">&#39;Visual2_L&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#get col name</span>
<span class="c1"># let&#39;s assume these lists have been populated with the relevant sections</span>


<span class="n">list_task</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Emotion&#39;</span><span class="p">,</span><span class="s1">&#39;Social&#39;</span><span class="p">,</span><span class="s1">&#39;Gambling&#39;</span><span class="p">]</span>


<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_columns</span><span class="p">)):</span>
    <span class="n">col_emotion</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_task</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">area</span> <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">network_columns</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_columns</span><span class="p">)):</span>
    <span class="n">col_social</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_task</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">area</span> <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">network_columns</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">network_columns</span><span class="p">)):</span>
    <span class="n">col_gambling</span> <span class="o">=</span> <span class="p">[</span><span class="n">list_task</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="n">area</span> <span class="k">for</span> <span class="n">area</span> <span class="ow">in</span> <span class="n">network_columns</span><span class="p">]</span>

<span class="c1">#check</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_emotion</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_social</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">col_gambling</span><span class="p">)</span>

<span class="n">list_columns_net</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;subject_id&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">col_emotion</span> <span class="o">+</span> <span class="n">col_social</span> <span class="o">+</span> <span class="n">col_gambling</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_columns_net</span><span class="p">)</span> <span class="o">==</span> <span class="mi">24</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Emotion_Auditory_L&#39;, &#39;Emotion_Auditory_R&#39;, &#39;Emotion_Cingulo-Oper_L&#39;, &#39;Emotion_Cingulo-Oper_R&#39;, &#39;Emotion_Default_L&#39;, &#39;Emotion_Default_R&#39;, &#39;Emotion_Dorsal-atten_L&#39;, &#39;Emotion_Dorsal-atten_R&#39;, &#39;Emotion_Frontopariet_L&#39;, &#39;Emotion_Frontopariet_R&#39;, &#39;Emotion_Language_L&#39;, &#39;Emotion_Language_R&#39;, &#39;Emotion_Orbito-Affec_L&#39;, &#39;Emotion_Orbito-Affec_R&#39;, &#39;Emotion_Posterior-Mu_L&#39;, &#39;Emotion_Posterior-Mu_R&#39;, &#39;Emotion_Somatomotor_L&#39;, &#39;Emotion_Somatomotor_R&#39;, &#39;Emotion_Ventral-Mult_L&#39;, &#39;Emotion_Ventral-Mult_R&#39;, &#39;Emotion_Visual1_L&#39;, &#39;Emotion_Visual1_R&#39;, &#39;Emotion_Visual2_L&#39;, &#39;Emotion_Visual2_L&#39;]
[&#39;Social_Auditory_L&#39;, &#39;Social_Auditory_R&#39;, &#39;Social_Cingulo-Oper_L&#39;, &#39;Social_Cingulo-Oper_R&#39;, &#39;Social_Default_L&#39;, &#39;Social_Default_R&#39;, &#39;Social_Dorsal-atten_L&#39;, &#39;Social_Dorsal-atten_R&#39;, &#39;Social_Frontopariet_L&#39;, &#39;Social_Frontopariet_R&#39;, &#39;Social_Language_L&#39;, &#39;Social_Language_R&#39;, &#39;Social_Orbito-Affec_L&#39;, &#39;Social_Orbito-Affec_R&#39;, &#39;Social_Posterior-Mu_L&#39;, &#39;Social_Posterior-Mu_R&#39;, &#39;Social_Somatomotor_L&#39;, &#39;Social_Somatomotor_R&#39;, &#39;Social_Ventral-Mult_L&#39;, &#39;Social_Ventral-Mult_R&#39;, &#39;Social_Visual1_L&#39;, &#39;Social_Visual1_R&#39;, &#39;Social_Visual2_L&#39;, &#39;Social_Visual2_L&#39;]
[&#39;Gambling_Auditory_L&#39;, &#39;Gambling_Auditory_R&#39;, &#39;Gambling_Cingulo-Oper_L&#39;, &#39;Gambling_Cingulo-Oper_R&#39;, &#39;Gambling_Default_L&#39;, &#39;Gambling_Default_R&#39;, &#39;Gambling_Dorsal-atten_L&#39;, &#39;Gambling_Dorsal-atten_R&#39;, &#39;Gambling_Frontopariet_L&#39;, &#39;Gambling_Frontopariet_R&#39;, &#39;Gambling_Language_L&#39;, &#39;Gambling_Language_R&#39;, &#39;Gambling_Orbito-Affec_L&#39;, &#39;Gambling_Orbito-Affec_R&#39;, &#39;Gambling_Posterior-Mu_L&#39;, &#39;Gambling_Posterior-Mu_R&#39;, &#39;Gambling_Somatomotor_L&#39;, &#39;Gambling_Somatomotor_R&#39;, &#39;Gambling_Ventral-Mult_L&#39;, &#39;Gambling_Ventral-Mult_R&#39;, &#39;Gambling_Visual1_L&#39;, &#39;Gambling_Visual1_R&#39;, &#39;Gambling_Visual2_L&#39;, &#39;Gambling_Visual2_L&#39;]
True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="n">list_all_data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_contrast_net_emotion</span><span class="p">)):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exc_subjects</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_contrast_net_emotion</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_contrast_net_social</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_contrast_net_gambling</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>

    <span class="n">list_all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>


<span class="n">df_BOLD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_all_data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">list_columns_net</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_BOLD</span><span class="p">)</span>
<span class="n">df_BOLD</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;BOLD_contrast_network_98.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   subject_id  Emotion_Auditory_L  Emotion_Auditory_R  Emotion_Cingulo-Oper_L  \
0      100307           -2.804921           -2.433804               -0.777985   
1      100408            3.516186            7.529671               -9.521039   
2      101915            9.980518            5.266869                9.546204   
3      102816           20.833271          -16.487274                1.886792   
4      103414            9.885700            5.633930                9.734162   
..        ...                 ...                 ...                     ...   
93     199655           -3.796242           -3.248363              -12.931731   
94     200614           -2.340933           -0.460370               -6.904875   
95     201111           -0.313696           -3.006372                7.014663   
96     201414            9.047621            3.032789               -4.672088   
97     205119           18.881525           12.401503                7.964594   

    Emotion_Cingulo-Oper_R  Emotion_Default_L  Emotion_Default_R  \
0                -0.353353          10.053771           5.986613   
1                -5.284645          -8.731886           7.884268   
2                11.319655           8.908589          20.103598   
3                -0.946059          10.643481           3.247931   
4                 9.824339          13.819462          21.356125   
..                     ...                ...                ...   
93               -7.968932          -1.838899          -2.248285   
94              -13.213405          -0.929012          -7.979797   
95               -1.106524           7.094315           1.009450   
96               -2.014852           0.149621          22.042231   
97               -0.326323          24.005220          15.183962   

    Emotion_Dorsal-atten_L  Emotion_Dorsal-atten_R  Emotion_Frontopariet_L  \
0                11.420777                8.673832                4.628537   
1                11.791724                1.867515               -8.937923   
2                 0.907064               12.911264                2.576694   
3                13.517639               13.682730               -7.682030   
4                21.945681                7.596248               13.637148   
..                     ...                     ...                     ...   
93               -0.109514                1.404556               -8.534893   
94               11.367749               18.012441               -1.613193   
95                9.850395                6.223135                2.587723   
96                1.823159               22.238250               -1.161439   
97               16.718064                9.807230               15.608610   

    ...  Gambling_Posterior-Mu_L  Gambling_Posterior-Mu_R  \
0   ...                -7.973004                 2.530932   
1   ...               -24.315753               -18.506888   
2   ...                -1.944254                -0.950986   
3   ...                -3.673315                -2.800902   
4   ...                 9.498112                 7.589702   
..  ...                      ...                      ...   
93  ...                -4.010796                 1.193511   
94  ...                11.388163                11.611773   
95  ...                -1.079248                10.458447   
96  ...                 4.350870                 2.288127   
97  ...               -15.698724               -16.134373   

    Gambling_Somatomotor_L  Gambling_Somatomotor_R  Gambling_Ventral-Mult_L  \
0                -3.179724               -1.810594                -7.124124   
1                -6.057032                4.568156               -48.646206   
2                 0.150241                3.160913                -8.325856   
3                12.236763                6.242775                -9.369718   
4                 4.858379               14.831399                21.459354   
..                     ...                     ...                      ...   
93                0.801685               -0.544744                -0.791156   
94              -12.670486                4.437090                 1.793672   
95              -10.125810               -8.503565                 6.909634   
96               -0.454990                7.512785                10.580950   
97              -19.458602              -16.554394               -16.920817   

    Gambling_Ventral-Mult_R  Gambling_Visual1_L  Gambling_Visual1_R  \
0                  1.524933           -3.339643           -3.025932   
1                -11.067792          -16.796800           -5.983401   
2                 -9.110250           -7.625908           -1.689586   
3                -12.720637            8.636415           20.621203   
4                 -7.949689           18.820264           10.545901   
..                      ...                 ...                 ...   
93                22.397713           -2.309791            9.854299   
94                -0.470018           -8.310730            9.031029   
95                26.248419           15.927485           13.441762   
96                 7.709618            0.995246            0.200687   
97               -41.737430           14.800047           19.709679   

    Gambling_Visual2_L  Gambling_Visual2_L  
0             8.826484            7.199637  
1            -8.297101            6.657371  
2            -1.384789            1.175621  
3             9.931208            8.350895  
4            12.616854           12.111169  
..                 ...                 ...  
93           -1.874123            0.729667  
94           -6.830466           -0.281131  
95            6.393254            4.603233  
96            3.556047           14.316392  
97           -5.829851          -10.290764  

[98 rows x 73 columns]
</pre></div>
</div>
</div>
</div>
<section id="columns-for-360-areas">
<h3>Columns for 360 areas<a class="headerlink" href="#columns-for-360-areas" title="Permalink to this heading">#</a></h3>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#get col name</span>
<span class="c1"># let&#39;s assume these lists have been populated with the relevant sections</span>
<span class="n">list_columns</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;subject_id&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_fear_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_neut_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;contrast_emotion_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_mental_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_random_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;contrast_social_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_win_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;BOLD_loss_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">360</span><span class="p">):</span>
    <span class="n">list_columns</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;contrast_gambling_</span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">360</span><span class="o">*</span><span class="mi">9</span> <span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>


<span class="n">list_all_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">row_idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">list_indiv_BOLD_fear</span><span class="p">)):</span>
    <span class="n">row</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">row</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">exc_subjects</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_fear</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_neut</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_contrast_emotion</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_mental</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_random</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_contrast_social</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_win</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_BOLD_loss</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">row</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">list_indiv_contrast_gambling</span><span class="p">[</span><span class="n">row_idx</span><span class="p">])</span>
    <span class="n">list_all_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>


<span class="n">df_BOLD</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">list_all_data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">list_columns</span><span class="p">)</span>
<span class="n">df_BOLD</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;BOLD_98_individual.csv&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">drive</span>
<span class="n">drive</span><span class="o">.</span><span class="n">mount</span><span class="p">(</span><span class="s1">&#39;/content/drive&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="id1">
<h2>SOCIAL Task<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#SOCIAL task average frame calculate</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;SOCIAL&#39;</span>
<span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#use load_single_timeseries</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                              <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                              <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                              <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#use load_evs</span>
<span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
<span class="c1">#use average frame</span>
<span class="n">rand_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;rnd&#39;</span><span class="p">)</span>
<span class="n">mental_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;mental&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># SOCIAL: Plot activity level in each ROI for both conditions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rand_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">mental_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;mental&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>GAMBLING task<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#GAMBLING task average frame calculate</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;GAMBLING&#39;</span>
<span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1">#use load_single_timeseries</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                              <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                              <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                              <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#use load_evs</span>
<span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
<span class="c1">#use average frame</span>
<span class="n">win_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
<span class="n">loss_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">)</span>


<span class="c1"># GAMBLING: Plot activity level in each ROI for both conditions</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">win_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;win&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss_activity</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="try-plotting-the-average-frame-data-of-all-subjects">
<h3>Try plotting the “average frame” data of ALL subjects<a class="headerlink" href="#try-plotting-the-average-frame-data-of-all-subjects" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># try plotting Brain activity for each tasks</span>

<span class="c1"># Gambling</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;GAMBLING&#39;</span>


<span class="n">subj_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">EXPERIMENTS</span><span class="p">[</span><span class="n">my_exp</span><span class="p">][</span><span class="s1">&#39;cond&#39;</span><span class="p">]:</span>
  <span class="n">list_activity</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># initializing the list_ activity</span>
  <span class="k">for</span> <span class="n">subj_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)):</span>
    <span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">subj_i</span><span class="p">]</span>
    <span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                            <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                            <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                            <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
    <span class="n">gambling_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span><span class="n">my_exp</span><span class="p">,</span><span class="n">cond</span><span class="p">)</span>
    <span class="c1"># Plot activity level in each ROI for both conditions</span>
    <span class="n">list_activity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gambling_activity</span><span class="p">)</span>

    <span class="n">subj_no</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">list_activity</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># try plotting Brain activity for each tasks</span>

<span class="c1">#</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;SOCIAL&#39;</span>


<span class="n">subj_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">EXPERIMENTS</span><span class="p">[</span><span class="n">my_exp</span><span class="p">][</span><span class="s1">&#39;cond&#39;</span><span class="p">]:</span>
  <span class="n">list_activity</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># initializing the list_ activity</span>
  <span class="k">for</span> <span class="n">subj_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)):</span>
    <span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">subj_i</span><span class="p">]</span>
    <span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                            <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                            <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                            <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
    <span class="n">gambling_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span><span class="n">my_exp</span><span class="p">,</span><span class="n">cond</span><span class="p">)</span>
    <span class="c1"># Plot activity level in each ROI for both conditions</span>
    <span class="n">list_activity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">gambling_activity</span><span class="p">)</span>

    <span class="n">subj_no</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">list_activity</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;ROI&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;activity&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

  <span class="c1"># plot according to the network</span>

  <span class="n">avg_activity</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">list_activity</span><span class="p">)</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;average&#39;</span><span class="p">,</span><span class="n">avg_activity</span><span class="p">)</span>
  <span class="c1"># plt.plot(avg_activity)</span>
  <span class="c1"># plt.xlabel(&#39;ROI&#39;)</span>
  <span class="c1"># plt.ylabel(&#39;activity&#39;)</span>
  <span class="c1"># plt.legend()</span>
  <span class="c1"># plt.title(&#39;average&#39;)</span>
  <span class="c1"># plt.show()</span>
  <span class="c1"># df = pd.DataFrame({&#39;neutral_activity&#39; : avg_activity,</span>
  <span class="c1">#                  &#39;network&#39; : region_info[&#39;network&#39;],</span>
  <span class="c1">#                  &#39;hemi&#39; : region_info[&#39;hemi&#39;]})</span>

  <span class="c1"># sns.barplot(y=&#39;network&#39;, x=&#39;neutral_activity&#39;, data=df, hue=&#39;hemi&#39;)</span>
  <span class="c1"># plt.show()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#try running through all the data and subjects to check if all the data can be accessed</span>

<span class="n">subj_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">subj_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)):</span>
  <span class="k">for</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">conds</span> <span class="ow">in</span> <span class="n">EXPERIMENTS</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">conds</span><span class="p">[</span><span class="s1">&#39;cond&#39;</span><span class="p">]:</span>
      <span class="n">my_exp</span> <span class="o">=</span> <span class="n">experiment</span>
      <span class="n">my_subj</span> <span class="o">=</span> <span class="n">subjects</span><span class="p">[</span><span class="n">subj_i</span><span class="p">]</span>
      <span class="n">my_run</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span>
                              <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                              <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">,</span>
                              <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
      <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">my_subj</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span> <span class="n">run</span><span class="o">=</span><span class="n">my_run</span><span class="p">)</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="n">evs</span><span class="p">,</span><span class="n">my_exp</span><span class="p">,</span><span class="n">cond</span><span class="p">)</span>
      <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;error: &#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">subj_i</span><span class="p">),</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">cond</span><span class="p">)</span>

  <span class="n">subj_no</span> <span class="o">+=</span> <span class="mi">1</span>

</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="contrast-and-network">
<h2>Contrast and network<a class="headerlink" href="#contrast-and-network" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Now let’s plot these activity vectors. We will also make use of the ROI names to find out which brain areas show highest activity in these conditions. But since there are so many areas, we will group them by network.</p>
<p>A powerful tool for organising and plotting this data is the combination of pandas and seaborn. Below is an example where we use pandas to create a table for the activity data and we use seaborn oto visualise it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#EMOTION task</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fear_activity&#39;</span> <span class="p">:</span> <span class="n">fear_activity</span><span class="p">,</span>
                   <span class="s1">&#39;neut_activity&#39;</span> <span class="p">:</span> <span class="n">neut_activity</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]})</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;fear_activity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;neut_activity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/HCP_fMRI_NMA_74_0.png" src="_images/HCP_fMRI_NMA_74_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#SOCIAL task</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;mental_activity&#39;</span> <span class="p">:</span> <span class="n">mental_activity</span><span class="p">,</span>
                   <span class="s1">&#39;rand_activity&#39;</span> <span class="p">:</span> <span class="n">rand_activity</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]})</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;mental_activity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">)</span> <span class="c1">#sns barplot prob. show only 10 first regions</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;rand_activity&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>You should be able to notice that for the somatosensory network, brain activity in the right hemi is higher for the left foot movement and vice versa for the left hemi and right foot. But this may be subtle at the single subject/session level (these are quick 3-4min scans).</p>
<p>Let us boost thee stats by averaging across all subjects and runs.</p>
</section>
<section id="average-across-all-subjects-and-runs">
<h2>Average across all subjects and runs<a class="headerlink" href="#average-across-all-subjects-and-runs" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>#EMOTION task</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#EMOTION</span>
<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;EMOTION&#39;</span> <span class="c1">#&#39;SOCIAL&#39; , &#39;GAMBLING&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">group_contrast_emotion</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

    <span class="n">fear_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;fear&#39;</span><span class="p">)</span>
    <span class="n">neut_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;neut&#39;</span><span class="p">)</span>

    <span class="n">contrast</span> <span class="o">=</span> <span class="n">fear_activity</span> <span class="o">-</span> <span class="n">neut_activity</span>
    <span class="n">group_contrast_emotion</span> <span class="o">+=</span> <span class="n">contrast</span>

<span class="n">group_contrast_emotion</span> <span class="o">/=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># remember: 2 sessions per subject</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;contrast&#39;</span> <span class="p">:</span> <span class="n">group_contrast_emotion</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]</span>
                   <span class="p">})</span>
<span class="c1"># we will plot the fear foot minus neutral foot contrast so we only need one plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;group contrast of fear vs neutral&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualising-the-results-on-a-brain">
<h2>Visualising the results on a brain<a class="headerlink" href="#visualising-the-results-on-a-brain" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<p>Finally, we will visualise these resuts on the cortical surface of an average brain.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title NMA provides an atlas. Run this cell to download it</span>
<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">requests</span>

<span class="c1"># NMA provides an atlas</span>
<span class="n">fname</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">HCP_DIR</span><span class="si">}</span><span class="s2">/atlas.npz&quot;</span>
<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://osf.io/j5kuc/download&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="k">try</span><span class="p">:</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
  <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;!!! Failed to download data !!!&quot;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">r</span><span class="o">.</span><span class="n">status_code</span> <span class="o">!=</span> <span class="n">requests</span><span class="o">.</span><span class="n">codes</span><span class="o">.</span><span class="n">ok</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;!!! Failed to download data !!!&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fid</span><span class="p">:</span>
        <span class="n">fid</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>

<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">dobj</span><span class="p">:</span>
  <span class="n">atlas</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="o">**</span><span class="n">dobj</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># This uses the nilearn package</span>
<span class="kn">from</span> <span class="nn">nilearn</span> <span class="kn">import</span> <span class="n">plotting</span><span class="p">,</span> <span class="n">datasets</span>

<span class="c1"># Try both hemispheres (L-&gt;R and left-&gt;right)</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>
<span class="n">surf_contrast</span> <span class="o">=</span> <span class="n">group_contrast_emotion</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s2">&quot;labels_L&quot;</span><span class="p">]]</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">view_surf</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;infl_left&#39;</span><span class="p">],</span>
                   <span class="n">surf_contrast</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="group-contrast-for-social-and-gambling-respectively">
<h3>Group contrast for Social and Gambling respectively<a class="headerlink" href="#group-contrast-for-social-and-gambling-respectively" title="Permalink to this heading">#</a></h3>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#SOCIAL</span>

<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;SOCIAL&#39;</span>
<span class="c1">#calculate group contrast SOCIAL</span>
<span class="n">group_contrast_social</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

    <span class="n">mental_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;mental&#39;</span><span class="p">)</span>
    <span class="n">rnd_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;rnd&#39;</span><span class="p">)</span>

    <span class="n">contrast</span> <span class="o">=</span> <span class="n">mental_activity</span> <span class="o">-</span> <span class="n">rnd_activity</span>
    <span class="n">group_contrast_social</span> <span class="o">+=</span> <span class="n">contrast</span>

<span class="n">group_contrast_social</span> <span class="o">/=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># remember: 2 sessions per subject</span>



<span class="c1">#Plot contrast bar graph SOCIAL</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;contrast&#39;</span> <span class="p">:</span> <span class="n">group_contrast_social</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]</span>
                   <span class="p">})</span>
<span class="c1"># we will plot the fear foot minus neutral foot contrast so we only need one plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;group contrast of mental vs random&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#PLot the on atlas SOCIAL</span>
<span class="c1"># Try both hemispheres (L-&gt;R and left-&gt;right)</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>
<span class="n">surf_contrast</span> <span class="o">=</span> <span class="n">group_contrast_social</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s2">&quot;labels_L&quot;</span><span class="p">]]</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">view_surf</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;infl_left&#39;</span><span class="p">],</span>
                   <span class="n">surf_contrast</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#try: fsaverage[&#39;infl_right&#39;], Labels_R</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>
<span class="n">surf_contrast</span> <span class="o">=</span> <span class="n">group_contrast_social</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s2">&quot;labels_R&quot;</span><span class="p">]]</span>
<span class="n">plotting</span><span class="o">.</span><span class="n">view_surf</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;infl_right&#39;</span><span class="p">],</span>
                   <span class="n">surf_contrast</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="gambling">
<h2>GAMBLING<a class="headerlink" href="#gambling" title="Permalink to this heading">#</a></h2>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#GAMBLING</span>

<span class="n">my_exp</span> <span class="o">=</span> <span class="s1">&#39;GAMBLING&#39;</span>
<span class="c1">#calculate group contrast GAMBLING</span>
<span class="n">group_contrast_gambling</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">subjects</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_single_timeseries</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span>
                                  <span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">remove_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">evs</span> <span class="o">=</span> <span class="n">load_evs</span><span class="p">(</span><span class="n">subject</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">experiment</span><span class="o">=</span><span class="n">my_exp</span><span class="p">,</span><span class="n">run</span><span class="o">=</span><span class="n">r</span><span class="p">)</span>

    <span class="n">win_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;win&#39;</span><span class="p">)</span>
    <span class="n">loss_activity</span> <span class="o">=</span> <span class="n">average_frames</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">my_exp</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">)</span>

    <span class="n">contrast</span> <span class="o">=</span> <span class="n">win_activity</span> <span class="o">-</span> <span class="n">loss_activity</span>
    <span class="n">group_contrast_gambling</span> <span class="o">+=</span> <span class="n">contrast</span>

<span class="n">group_contrast_gambling</span> <span class="o">/=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">subjects</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># remember: 2 sessions per subject</span>



<span class="c1">#Plot contrast bar graph GAMBLING</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;contrast&#39;</span> <span class="p">:</span> <span class="n">group_contrast_gambling</span><span class="p">,</span>
                   <span class="s1">&#39;network&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;network&#39;</span><span class="p">],</span>
                   <span class="s1">&#39;hemi&#39;</span> <span class="p">:</span> <span class="n">region_info</span><span class="p">[</span><span class="s1">&#39;hemi&#39;</span><span class="p">]</span>
                   <span class="p">})</span>
<span class="c1"># we will plot the fear foot minus neutral foot contrast so we only need one plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;network&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;contrast&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;hemi&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;group contrast of win vs loss&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">#PLot the on atlas SOCIAL</span>
<span class="c1"># Try both hemispheres (L-&gt;R and left-&gt;right)</span>
<span class="n">fsaverage</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">fetch_surf_fsaverage</span><span class="p">()</span>
<span class="n">surf_contrast</span> <span class="o">=</span> <span class="n">group_contrast_gambling</span><span class="p">[</span><span class="n">atlas</span><span class="p">[</span><span class="s2">&quot;labels_L&quot;</span><span class="p">]]</span>

<span class="n">plotting</span><span class="o">.</span><span class="n">view_surf</span><span class="p">(</span><span class="n">fsaverage</span><span class="p">[</span><span class="s1">&#39;infl_left&#39;</span><span class="p">],</span>
                   <span class="n">surf_contrast</span><span class="p">,</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="archived-codes">
<h3>Archived Codes<a class="headerlink" href="#archived-codes" title="Permalink to this heading">#</a></h3>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">average_frames_modi</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">evs</span><span class="p">,</span> <span class="n">experiment</span><span class="p">,</span> <span class="n">cond</span><span class="p">):</span>

  <span class="n">idx</span> <span class="o">=</span> <span class="n">EXPERIMENTS</span><span class="p">[</span><span class="n">experiment</span><span class="p">][</span><span class="s1">&#39;cond&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cond</span><span class="p">)</span> <span class="c1">#the index of condition ex. &#39;fear&#39; = 0, &#39;neut = 1&#39; this depends on the position of that condition in dict EXPERIMENT</span>
  <span class="n">list_of_mean</span> <span class="o">=</span> <span class="p">[]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(data[:, evs[idx][i]])&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;evs[idx][i]&quot;</span><span class="p">,</span><span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;data[:, evs[idx][i]]&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]])</span>

    <span class="n">list_of_mean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">evs</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">i</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(list_of_mean)&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">))</span> <span class="c1"># ==&gt; the list of mean is a list(2) of lists (360); this is the same as the result of list comprehension below</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(list_of_mean[0])&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="c1">#print(&quot;list_of_mean&quot;,list_of_mean)</span>
  <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(np.concatenate(list_of_mean,axis=-1))&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;np.concatenate(list_of_mean,axis=-1)&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">,</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;len(np.mean(np.concatenate(list_of_mean), axis=1))&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;np.mean(np.concatenate(list_of_mean), axis=1)&quot;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
  <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">list_of_mean</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="project_main.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Helper Script</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="test_model_NMA.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Model Fitting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Cognitive Cortex Crew<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>